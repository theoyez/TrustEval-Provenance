<!doctype html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Compare runs — Pro</title><link rel="stylesheet" href="../config/theme.css"><style>
body{background:var(--bg);color:var(--ink);font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;margin:0}
.wrap{max-width:1100px;margin:0 auto;padding:16px}
.btn{display:inline-block;padding:8px 12px;border:1px solid var(--muted);border-radius:10px;background:#141617;color:var(--ink);text-decoration:none}
.row{display:flex;gap:8px;flex-wrap:wrap;align-items:center;margin:12px 0}
select{background:#121416;color:var(--ink);border:1px solid var(--muted);border-radius:8px;padding:8px;min-width:260px}
table{width:100%;border-collapse:collapse;margin-top:16px;background:#111315;border:1px solid var(--muted);border-radius:12px;overflow:hidden}
th,td{padding:12px;border-bottom:1px solid var(--muted);vertical-align:top}
thead th{background:#141617}
.small{color:var(--ink-dim);font-size:12px}
.delta-pos{color:#8df0b6}.delta-neg{color:#ffb3b3}.delta-zero{color:#cbd0d6}
.pill{border:1px solid var(--muted);padding:4px 10px;border-radius:999px;background:#131416;margin:4px 6px 0 0;display:inline-block}
.chips{display:flex;flex-wrap:wrap;margin-top:6px}
</style></head><body>
<div class="wrap">
  <a class="btn" href="../index.html">← Leaderboard</a>
  <h2>Compare runs</h2>
  <p class="small">Pick two runs. The table shows per-metric scores and Δ (right − left). Use the button to open both reports.</p>
  <div class="row">
    <label class="small" for="leftSel">Left</label>
    <select id="leftSel"></select>
    <label class="small" for="rightSel">Right</label>
    <select id="rightSel"></select>
    <a id="openBtn" class="btn" href="javascript:void(0)">Open reports</a>
  </div>
  <div id="chips" class="chips small"></div>
  <table id="t" style="display:none"><thead><tr><th>Metric</th><th id="lh"></th><th id="rh"></th><th>Δ (right−left)</th></tr></thead><tbody id="tb"></tbody></table>
</div>
<script>
(async function(){
  const pct=x=>(x*100).toFixed(1)+'%';
  async function loadBoard(){
    const paths=['../leaderboard.json','./leaderboard.json','/leaderboard.json'];
    for (const p of paths){
      try{ const r=await fetch(p); if(r.ok){ return r.json(); } }catch(e){}
    }
    return {runs:[]};
  }
  const site=await fetch('../config/site.json').then(r=>r.json());
  const board=await loadBoard();
  const runs=board.runs||[];
  const cols = site.show_columns.filter(k=>!['run_id','model','provenance'].includes(k));

  function opt(r){ return `<option value="${r.run_id}">${r.run_id} — ${r.model||'—'}</option>`; }
  leftSel.innerHTML = runs.map(opt).join('');
  rightSel.innerHTML= runs.map(opt).join('');
  if(runs.length>1) rightSel.selectedIndex=1;

  function pills(prefix, m, prov){
    const list=[]; if(m?.model) list.push(`model: ${m.model}`);
    ['dataset','prompt_cfg','retriever','date'].forEach(k=>{ if(m?.[k]) list.push(`${k}: ${m[k]}`); });
    if(prov?.status) list.push(`prov: ${prov.status}`);
    return list.map(x=>`<span class="pill">${prefix} ${x}</span>`).join('');
  }

  function get(id){ return runs.find(r=>r.run_id===id); }
  function render(){
    const L=get(leftSel.value), R=get(rightSel.value);
    if(!L||!R){ t.style.display='none'; chips.innerHTML='<span class="small">No runs available.</span>'; return; }
    t.style.display='table';
    lh.textContent=L.run_id; rh.textContent=R.run_id;
    chips.innerHTML = pills('L',L.meta,L.provenance)+pills('R',R.meta,R.provenance);
    tb.innerHTML = cols.map(k=>{
      const label=(site.labels&&site.labels[k])||k;
      const lv=Number(L[k]||0), rv=Number(R[k]||0), d=rv-lv;
      const cls=d>0?'delta-pos':d<0?'delta-neg':'delta-zero';
      return `<tr><td>${label}</td><td>${pct(lv)}</td><td>${pct(rv)}</td><td class="${cls}">${(d*100).toFixed(1)}%</td></tr>`;
    }).join('');
    openBtn.onclick=()=>{ if(L.report) window.open('../'+L.report,'_blank'); if(R.report) window.open('../'+R.report,'_blank'); };
  }
  leftSel.addEventListener('change',render);
  rightSel.addEventListener('change',render);
  render();
})();
</script></body></html>